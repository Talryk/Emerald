{"type":"group","name":"EmeraldFactions","enabled":true,"items":[{"type":"function","name":"onInstall","enabled":true,"code":"client.emerald.factions = {};\nlet factions = client.emerald.factions;\n\nfactions.colors = get_variable('emerald_factions_colors') ? JSON.parse(get_variable('emerald_factions_colors')) : {};\nfactions.names = get_variable('emerald_factions_names') ? JSON.parse(get_variable('emerald_factions_names')) : {};\n\nfactions.save = () => {\n  set_variable('emerald_factions_colors',JSON.stringify(factions.colors));\n  set_variable('emerald_factions_names',JSON.stringify(factions.names));\n}\nfactions.add = (name) => {\n  fetch(`https://api.lusternia.com/characters/${name}.json`)\n  .then(res => {\n    return res.json();\n  }).then(data => {\n    if (String(data).includes(' was not found')) {\n      //thing\n    } else {\n      let org;\n      if (['Spindle','Skein','Bobbins'].includes(name) || data.level == 'Infinite') {\n        org = 'Divine';\n      } else {\n        org = data.faction.charAt(0).toUpperCase() + data.faction.substr(1).toLowerCase();\n      }\n      factions[data.name] = org;\n      client.emerald.emnote(`${data.name} is of ${org}`, 'Factions');\n      factions.save();\n    }\n  })\n}"},{"type":"function","name":"onUninstall","enabled":true,"code":"// Place any code here you'd like to autorun when the package is uninstalled"},{"type":"function","name":"onLoad","enabled":true,"code":"run_function(\"onInstall\",\"\",\"EmeraldFactions\");"},{"type":"trigger","name":"highlight_target","enabled":false,"actions":[{"type":"script","enabled":true,"script":"let t = get_variable('target').toLowerCase();\nlet l = args[0].toLowerCase();\nif (l.indexOf(t) > -1) colorize_current_line(l.indexOf(t),t.length,'red');"}],"text":"^.*?$","matching":"regexp","whole_words":false,"case_sensitive":false}],"description":""}